---
import Layout from "../layouts/Layout.astro";
import Card from "../components/ui/Card.astro";
import CardHeader from "../components/ui/CardHeader.astro";
import CardContent from "../components/ui/CardContent.astro";
import Badge from "../components/ui/Badge.astro";
import Button from "../components/ui/Button.astro";
import Avatar from "../components/ui/Avatar.astro";
import Section from "../components/ui/Section.astro";
import Icon from "../components/ui/Icon.astro";
import ProjectCard from "../components/ProjectCard.astro";
import Resume from "../config/resume.ts";
import LinkedIn from "@/components/icons/linked-in.astro";
---

<Layout>
  <main
    class="container relative mx-auto overflow-auto py-4 md:py-16 print:py-12"
  >
    <section class="mx-auto w-full max-w-3xl space-y-8 print:space-y-6">
      <!-- Header -->
      <div class="flex items-center justify-between">
        <div class="flex-1 space-y-1.5">
          <h1 class="text-pretty text-4xl font-bold">
            {Resume.name}
          </h1>
          <p
            class="max-w-md text-pretty font-mono text-sm text-muted-foreground"
          >
            {Resume.about}
          </p>
          <p
            class="max-w-md items-center text-pretty font-mono text-sm text-muted-foreground"
          >
            <a
              class="inline-flex gap-x-1.5 align-baseline leading-none hover:underline"
              href={Resume.locationLink}
              target="_blank"
              rel="noopener noreferrer"
            >
              <Icon name="globe" class="size-3" />
              {Resume.location}
            </a>
          </p>
          <div
            class="flex gap-x-1 pt-1 font-mono text-sm text-muted-foreground print:hidden"
          >
            {
              Resume.contact.social.map((social) => (
                <Button
                  variant="outline"
                  size="icon"
                  href={social.url}
                  class="size-8"
                >
                  {social.name === "GitHub" ? (
                    <Icon name="github" class="size-4" />
                  ) : social.name === "LinkedIn" ? (
                    <LinkedIn
                      width={24}
                      height={24}
                      class="size-4 fill-primary"
                    />
                  ) : null}
                </Button>
              ))
            }
          </div>
        </div>

        <Avatar
          src={Resume.avatarUrl}
          alt={Resume.name}
          fallback={Resume.initials}
          class="ml-1 size-28"
        />
      </div>

      <!-- About -->
      <Section>
        <h2 class="text-xl font-bold">About</h2>
        <p class="text-pretty font-mono text-sm text-muted-foreground">
          {Resume.summary}
        </p>
      </Section>

      <!-- Education -->
      <Section>
        <h2 class="text-xl font-bold">Education</h2>
        {
          Resume.education.map((education) => (
            <Card>
              <CardHeader>
                <div class="flex items-center justify-between gap-x-2 text-base">
                  <h3 class="font-semibold leading-none">{education.degree}</h3>
                  <div class="text tabular-nums text-muted-foreground font-mono">
                    {education.extra}
                  </div>
                </div>
              </CardHeader>
              <CardContent class="mt-2">
                <div class="flex items-center justify-between gap-x-2">
                  <h3 class="leading-none text-sm text-muted-foreground">
                    {education.school}
                  </h3>
                  <div class="text-sm tabular-nums text-muted-foreground">
                    {education.year}
                  </div>
                </div>
              </CardContent>
            </Card>
          ))
        }
      </Section>

      <!-- Certifications -->
      <Section>
        <h2 class="text-xl font-bold">Certifications</h2>
        <div class="flex flex-wrap gap-4">
          {
            Resume.certifications.map((cert) => (
              <a
                href={cert.link}
                target="_blank"
                rel="noopener noreferrer"
                class="group flex flex-col items-center gap-2 rounded-lg border bg-card p-4 transition-all hover:shadow-md print:border-0 print:p-2"
              >
                <img
                  src={cert.image}
                  alt={cert.name}
                  class="h-24 w-24 object-contain"
                />
                <span class="text-center text-xs font-medium text-muted-foreground group-hover:text-foreground">
                  {cert.name}
                </span>
              </a>
            ))
          }
        </div>
      </Section>

      <!-- Skills -->
      <Section>
        <h2 class="text-xl font-bold">Skills</h2>
        <div class="space-y-3">
          <div>
            <h3 class="text-sm font-semibold text-muted-foreground mb-1">
              Languages
            </h3>
            <div class="flex flex-wrap gap-1">
              {Resume.skills.languages.map((skill) => <Badge>{skill}</Badge>)}
            </div>
          </div>
          <div>
            <h3 class="text-sm font-semibold text-muted-foreground mb-1">
              Frameworks & Libraries
            </h3>
            <div class="flex flex-wrap gap-1">
              {Resume.skills.frameworks.map((skill) => <Badge>{skill}</Badge>)}
            </div>
          </div>
          <div>
            <h3 class="text-sm font-semibold text-muted-foreground mb-1">
              Tools
            </h3>
            <div class="flex flex-wrap gap-1">
              {Resume.skills.tools.map((skill) => <Badge>{skill}</Badge>)}
            </div>
          </div>
          <div>
            <h3 class="text-sm font-semibold text-muted-foreground mb-1">
              Protocols & APIs
            </h3>
            <div class="flex flex-wrap gap-1">
              {Resume.skills.protocols.map((skill) => <Badge>{skill}</Badge>)}
            </div>
          </div>
        </div>
      </Section>

      <!-- Work Experience -->
      <Section>
        <h2 class="text-xl font-bold">Work Experience</h2>
        {
          Resume.work.map((work) => (
            <Card class="space-y-3">
              <CardHeader class="space-y-2">
                <div class="flex items-center justify-between gap-x-2 text-base">
                  <h3 class="inline-flex items-center justify-center gap-x-1 font-semibold leading-none">
                    <a
                      class="hover:underline"
                      href={work.link}
                      target="_blank"
                      rel="noopener noreferrer"
                    >
                      {work.company}
                    </a>
                    <h4 class="font-mono leading-none">{work.title}</h4>
                  </h3>
                </div>
                <div class="flex items-center justify-between gap-x-2 text-base">
                  <span class="inline-flex gap-x-1">
                    {work.badges.map((badge) => (
                      <Badge variant="brutal">{badge}</Badge>
                    ))}
                  </span>
                  <div class="text-xs tabular-nums text-muted-foreground">
                    {work.start}
                    {"end" in work && work.end ? ` - ${work.end}` : ""}
                  </div>
                </div>
              </CardHeader>
              <CardContent class="text-xs">
                <ul class="list-outside list-disc space-y-2 text-pretty px-2 pl-4 font-mono text-muted-foreground">
                  {work.bullets.map((bullet) => (
                    <li>{bullet}</li>
                  ))}
                </ul>
              </CardContent>
            </Card>
          ))
        }
      </Section>

      <!-- Publications -->
      <Section>
        <h2 class="text-xl font-bold">Publications</h2>
        {
          Resume.publications.map((pub) => (
            <Card>
              <CardHeader>
                <h3 class="font-semibold leading-tight text-base">
                  {pub.title}
                </h3>
                <p class="font-mono text-xs text-muted-foreground">
                  {pub.authors}
                </p>
              </CardHeader>
              <CardContent>
                <p class="font-mono text-xs text-muted-foreground italic">
                  {pub.venue}
                </p>
              </CardContent>
            </Card>
          ))
        }
      </Section>

      <!-- Projects -->
      <Section>
        <h2 class="text-xl font-bold">Projects</h2>
        <div class="grid grid-cols-1 gap-3 md:grid-cols-2">
          {
            Resume.projects.map((project) => (
              <ProjectCard
                title={project.title}
                description={project.description}
                tags={project.techStack}
                link={project.link?.href}
              />
            ))
          }
        </div>
      </Section>
    </section>
  </main>
</Layout>

<style>
  @media print {
    .print-force-new-page {
      break-before: page;
    }
  }
</style>
